// Shared data store for Phazur Labs Academy
// This provides mock data that syncs between admin and student dashboards

import {
  Course,
  Student,
  Instructor,
  Enrollment,
  LiveTraining,
  Activity,
  Certificate,
  AdminDashboardStats,
  StudentAnalytics,
  LiveTrainingPlatform,
  LiveTrainingStatus,
} from '@/lib/types'

// Re-export types for convenience
export type {
  Course,
  Student,
  Instructor,
  Enrollment,
  LiveTraining,
  Activity,
  Certificate,
  AdminDashboardStats,
  StudentAnalytics,
  LiveTrainingPlatform,
  LiveTrainingStatus,
}

// Mock Instructors
export const instructors: Instructor[] = [
  {
    id: 'instructor-1',
    email: 'sarah.johnson@phazurlabs.com',
    full_name: 'Sarah Johnson',
    avatar_url: '/avatars/sarah.jpg',
    role: 'instructor',
    bio: 'Senior Software Engineer with 10+ years of experience in React and frontend development.',
    expertise: ['React', 'TypeScript', 'Next.js', 'Frontend Architecture'],
    courses_created: ['course-1', 'course-7'],
    rating: 4.9,
    total_students: 15420,
    created_at: '2023-01-15T00:00:00Z',
    updated_at: '2024-01-15T00:00:00Z',
  },
  {
    id: 'instructor-2',
    email: 'michael.chen@phazurlabs.com',
    full_name: 'Michael Chen',
    avatar_url: '/avatars/michael.jpg',
    role: 'instructor',
    bio: 'TypeScript expert and former Google engineer specializing in type systems.',
    expertise: ['TypeScript', 'JavaScript', 'Node.js', 'System Design'],
    courses_created: ['course-2'],
    rating: 4.8,
    total_students: 12850,
    created_at: '2023-02-20T00:00:00Z',
    updated_at: '2024-01-10T00:00:00Z',
  },
  {
    id: 'instructor-3',
    email: 'emma.wilson@phazurlabs.com',
    full_name: 'Emma Wilson',
    avatar_url: '/avatars/emma.jpg',
    role: 'instructor',
    bio: 'Backend specialist with expertise in Node.js, APIs, and microservices.',
    expertise: ['Node.js', 'Express', 'MongoDB', 'PostgreSQL', 'APIs'],
    courses_created: ['course-3'],
    rating: 4.7,
    total_students: 9230,
    created_at: '2023-03-10T00:00:00Z',
    updated_at: '2024-01-12T00:00:00Z',
  },
  {
    id: 'instructor-4',
    email: 'dr.alex.turner@phazurlabs.com',
    full_name: 'Dr. Alex Turner',
    avatar_url: '/avatars/alex.jpg',
    role: 'instructor',
    bio: 'PhD in Machine Learning, former AI researcher at Stanford.',
    expertise: ['Machine Learning', 'Deep Learning', 'Python', 'TensorFlow', 'PyTorch'],
    courses_created: ['course-4', 'course-8'],
    rating: 4.9,
    total_students: 18750,
    created_at: '2023-01-05T00:00:00Z',
    updated_at: '2024-01-18T00:00:00Z',
  },
  {
    id: 'instructor-5',
    email: 'sophie.chen@phazurlabs.com',
    full_name: 'Sophie Chen',
    avatar_url: '/avatars/sophie.jpg',
    role: 'instructor',
    bio: 'Lead UX Designer at major tech companies, specializing in product design.',
    expertise: ['UI/UX Design', 'Figma', 'User Research', 'Design Systems'],
    courses_created: ['course-5'],
    rating: 4.9,
    total_students: 11200,
    created_at: '2023-04-15T00:00:00Z',
    updated_at: '2024-01-14T00:00:00Z',
  },
]

// Mock Courses (shared between admin and student)
export const courses: Course[] = [
  {
    id: 'course-1',
    title: 'Advanced React Patterns & Best Practices',
    slug: 'advanced-react-patterns',
    description: 'Master advanced React patterns including compound components, render props, and hooks composition.',
    thumbnail_url: '/courses/react-patterns.jpg',
    instructor_id: 'instructor-1',
    instructor: instructors[0],
    category: 'Web Development',
    level: 'advanced',
    status: 'published',
    visibility: 'public',
    price: 149,
    currency: 'USD',
    total_duration_minutes: 765,
    total_lessons: 48,
    total_videos: 45,
    rating: 4.9,
    reviews_count: 892,
    enrolled_students: 2847,
    completion_rate: 78,
    revenue: 424353,
    tags: ['React', 'JavaScript', 'Patterns', 'Hooks'],
    prerequisites: ['Basic React knowledge', 'JavaScript fundamentals'],
    learning_outcomes: [
      'Build reusable component libraries',
      'Implement advanced state patterns',
      'Optimize React performance',
    ],
    sections: [],
    created_at: '2024-01-15T00:00:00Z',
    updated_at: '2024-01-17T00:00:00Z',
    published_at: '2024-01-15T00:00:00Z',
  },
  {
    id: 'course-2',
    title: 'TypeScript Masterclass: Zero to Hero',
    slug: 'typescript-masterclass',
    description: 'Complete TypeScript course from basics to advanced type system features.',
    thumbnail_url: '/courses/typescript.jpg',
    instructor_id: 'instructor-2',
    instructor: instructors[1],
    category: 'Programming Languages',
    level: 'intermediate',
    status: 'published',
    visibility: 'public',
    price: 129,
    currency: 'USD',
    total_duration_minutes: 980,
    total_lessons: 56,
    total_videos: 52,
    rating: 4.8,
    reviews_count: 1245,
    enrolled_students: 3890,
    completion_rate: 82,
    revenue: 501810,
    tags: ['TypeScript', 'JavaScript', 'Type System'],
    prerequisites: ['JavaScript knowledge'],
    learning_outcomes: [
      'Master TypeScript type system',
      'Build type-safe applications',
      'Create reusable generic types',
    ],
    sections: [],
    created_at: '2023-11-20T00:00:00Z',
    updated_at: '2024-01-10T00:00:00Z',
    published_at: '2023-11-20T00:00:00Z',
  },
  {
    id: 'course-3',
    title: 'Node.js Backend Development',
    slug: 'nodejs-backend',
    description: 'Build scalable backend applications with Node.js, Express, and databases.',
    thumbnail_url: '/courses/nodejs.jpg',
    instructor_id: 'instructor-3',
    instructor: instructors[2],
    category: 'Backend Development',
    level: 'intermediate',
    status: 'published',
    visibility: 'public',
    price: 139,
    currency: 'USD',
    total_duration_minutes: 1095,
    total_lessons: 62,
    total_videos: 58,
    rating: 4.7,
    reviews_count: 756,
    enrolled_students: 2120,
    completion_rate: 71,
    revenue: 294680,
    tags: ['Node.js', 'Express', 'MongoDB', 'REST API'],
    prerequisites: ['JavaScript fundamentals', 'Basic programming concepts'],
    learning_outcomes: [
      'Build RESTful APIs',
      'Work with databases',
      'Implement authentication',
    ],
    sections: [],
    created_at: '2024-01-05T00:00:00Z',
    updated_at: '2024-01-16T00:00:00Z',
    published_at: '2024-01-05T00:00:00Z',
  },
  {
    id: 'course-4',
    title: 'Complete AI & Machine Learning Bootcamp 2024',
    slug: 'ai-ml-bootcamp',
    description: 'Comprehensive machine learning course covering supervised, unsupervised, and deep learning.',
    thumbnail_url: '/courses/ai-ml.jpg',
    instructor_id: 'instructor-4',
    instructor: instructors[3],
    category: 'AI & Machine Learning',
    level: 'intermediate',
    status: 'published',
    visibility: 'public',
    price: 199,
    currency: 'USD',
    total_duration_minutes: 1935,
    total_lessons: 85,
    total_videos: 78,
    rating: 4.9,
    reviews_count: 1523,
    enrolled_students: 4560,
    completion_rate: 65,
    revenue: 907440,
    tags: ['Machine Learning', 'Python', 'TensorFlow', 'Deep Learning'],
    prerequisites: ['Python basics', 'Basic math'],
    learning_outcomes: [
      'Build ML models from scratch',
      'Implement neural networks',
      'Deploy ML applications',
    ],
    sections: [],
    created_at: '2024-01-01T00:00:00Z',
    updated_at: '2024-01-18T00:00:00Z',
    published_at: '2024-01-01T00:00:00Z',
  },
  {
    id: 'course-5',
    title: 'UI/UX Design Masterclass',
    slug: 'uiux-design-masterclass',
    description: 'Learn professional UI/UX design with Figma, user research, and design systems.',
    thumbnail_url: '/courses/uiux.jpg',
    instructor_id: 'instructor-5',
    instructor: instructors[4],
    category: 'Design',
    level: 'intermediate',
    status: 'published',
    visibility: 'public',
    price: 129,
    currency: 'USD',
    total_duration_minutes: 2180,
    total_lessons: 52,
    total_videos: 48,
    rating: 4.9,
    reviews_count: 756,
    enrolled_students: 2120,
    completion_rate: 85,
    revenue: 273480,
    tags: ['UI Design', 'UX Design', 'Figma', 'Design Systems'],
    prerequisites: ['No prerequisites'],
    learning_outcomes: [
      'Design professional user interfaces',
      'Conduct user research',
      'Build design systems',
    ],
    sections: [],
    created_at: '2024-01-05T00:00:00Z',
    updated_at: '2024-01-18T00:00:00Z',
    published_at: '2024-01-05T00:00:00Z',
  },
  {
    id: 'course-6',
    title: 'AWS Certified Solutions Architect',
    slug: 'aws-solutions-architect',
    description: 'Prepare for AWS Solutions Architect certification with hands-on labs.',
    thumbnail_url: '/courses/aws.jpg',
    instructor_id: 'instructor-3',
    instructor: instructors[2],
    category: 'Cloud Computing',
    level: 'advanced',
    status: 'published',
    visibility: 'public',
    price: 179,
    currency: 'USD',
    total_duration_minutes: 1725,
    total_lessons: 68,
    total_videos: 62,
    rating: 4.7,
    reviews_count: 523,
    enrolled_students: 1560,
    completion_rate: 71,
    revenue: 279240,
    tags: ['AWS', 'Cloud', 'DevOps', 'Certification'],
    prerequisites: ['Basic cloud knowledge', 'Linux basics'],
    learning_outcomes: [
      'Design AWS architectures',
      'Pass AWS certification exam',
      'Implement cloud solutions',
    ],
    sections: [],
    created_at: '2023-12-10T00:00:00Z',
    updated_at: '2024-01-15T00:00:00Z',
    published_at: '2023-12-10T00:00:00Z',
  },
  {
    id: 'course-7',
    title: 'Next.js 14 Full Course',
    slug: 'nextjs-14-full-course',
    description: 'Build modern full-stack applications with Next.js 14, App Router, and Server Components.',
    thumbnail_url: '/courses/nextjs.jpg',
    instructor_id: 'instructor-1',
    instructor: instructors[0],
    category: 'Web Development',
    level: 'intermediate',
    status: 'published',
    visibility: 'public',
    price: 89,
    currency: 'USD',
    total_duration_minutes: 1080,
    total_lessons: 45,
    total_videos: 42,
    rating: 4.9,
    reviews_count: 428,
    enrolled_students: 3250,
    completion_rate: 79,
    revenue: 289250,
    tags: ['Next.js', 'React', 'Full-Stack', 'Server Components'],
    prerequisites: ['React basics', 'JavaScript'],
    learning_outcomes: [
      'Build full-stack Next.js apps',
      'Use App Router and Server Components',
      'Deploy to production',
    ],
    sections: [],
    created_at: '2024-01-10T00:00:00Z',
    updated_at: '2024-01-18T00:00:00Z',
    published_at: '2024-01-10T00:00:00Z',
  },
  {
    id: 'course-8',
    title: 'Python for Data Science',
    slug: 'python-data-science',
    description: 'Learn Python for data analysis, visualization, and machine learning.',
    thumbnail_url: '/courses/python-ds.jpg',
    instructor_id: 'instructor-4',
    instructor: instructors[3],
    category: 'Data Science',
    level: 'beginner',
    status: 'draft',
    visibility: 'private',
    price: 99,
    currency: 'USD',
    total_duration_minutes: 1090,
    total_lessons: 48,
    total_videos: 44,
    rating: 0,
    reviews_count: 0,
    enrolled_students: 0,
    completion_rate: 0,
    revenue: 0,
    tags: ['Python', 'Data Science', 'Pandas', 'NumPy'],
    prerequisites: ['No prerequisites'],
    learning_outcomes: [
      'Analyze data with Python',
      'Create visualizations',
      'Build data pipelines',
    ],
    sections: [],
    created_at: '2024-03-01T00:00:00Z',
    updated_at: '2024-01-17T00:00:00Z',
  },
]

// Mock Students
export const students: Student[] = [
  {
    id: 'student-1',
    email: 'john.doe@example.com',
    full_name: 'John Doe',
    avatar_url: '/avatars/john.jpg',
    role: 'student',
    enrollments: [],
    certificates: [],
    streak_days: 7,
    total_hours_learned: 156,
    created_at: '2023-06-15T00:00:00Z',
    updated_at: '2024-01-18T00:00:00Z',
  },
  {
    id: 'student-2',
    email: 'sarah.smith@example.com',
    full_name: 'Sarah Smith',
    avatar_url: '/avatars/sarah-s.jpg',
    role: 'student',
    enrollments: [],
    certificates: [],
    streak_days: 12,
    total_hours_learned: 234,
    created_at: '2023-05-20T00:00:00Z',
    updated_at: '2024-01-18T00:00:00Z',
  },
  {
    id: 'student-3',
    email: 'michael.brown@example.com',
    full_name: 'Michael Brown',
    avatar_url: '/avatars/michael-b.jpg',
    role: 'student',
    enrollments: [],
    certificates: [],
    streak_days: 3,
    total_hours_learned: 89,
    created_at: '2023-09-10T00:00:00Z',
    updated_at: '2024-01-17T00:00:00Z',
  },
  {
    id: 'student-4',
    email: 'emily.wilson@example.com',
    full_name: 'Emily Wilson',
    avatar_url: '/avatars/emily.jpg',
    role: 'student',
    enrollments: [],
    certificates: [],
    streak_days: 21,
    total_hours_learned: 312,
    created_at: '2023-03-25T00:00:00Z',
    updated_at: '2024-01-18T00:00:00Z',
  },
  {
    id: 'student-5',
    email: 'james.taylor@example.com',
    full_name: 'James Taylor',
    avatar_url: '/avatars/james.jpg',
    role: 'student',
    enrollments: [],
    certificates: [],
    streak_days: 0,
    total_hours_learned: 45,
    created_at: '2023-11-05T00:00:00Z',
    updated_at: '2024-01-10T00:00:00Z',
  },
]

// Mock Enrollments (connecting students to courses)
export const enrollments: Enrollment[] = [
  {
    id: 'enrollment-1',
    student_id: 'student-1',
    student: students[0],
    course_id: 'course-1',
    course: courses[0],
    status: 'active',
    progress_percentage: 65,
    completed_lessons: Array.from({ length: 31 }, (_, i) => `lesson-${i + 1}`),
    last_accessed_at: new Date(Date.now() - 1000 * 60 * 60 * 2).toISOString(),
    enrolled_at: '2024-01-05T00:00:00Z',
  },
  {
    id: 'enrollment-2',
    student_id: 'student-1',
    course_id: 'course-2',
    student: students[0],
    course: courses[1],
    status: 'active',
    progress_percentage: 42,
    completed_lessons: Array.from({ length: 24 }, (_, i) => `lesson-${i + 1}`),
    last_accessed_at: new Date(Date.now() - 1000 * 60 * 60 * 24).toISOString(),
    enrolled_at: '2024-01-08T00:00:00Z',
  },
  {
    id: 'enrollment-3',
    student_id: 'student-1',
    course_id: 'course-3',
    student: students[0],
    course: courses[2],
    status: 'active',
    progress_percentage: 23,
    completed_lessons: Array.from({ length: 14 }, (_, i) => `lesson-${i + 1}`),
    last_accessed_at: new Date(Date.now() - 1000 * 60 * 60 * 48).toISOString(),
    enrolled_at: '2024-01-10T00:00:00Z',
  },
  {
    id: 'enrollment-4',
    student_id: 'student-2',
    course_id: 'course-1',
    student: students[1],
    course: courses[0],
    status: 'completed',
    progress_percentage: 100,
    completed_lessons: Array.from({ length: 48 }, (_, i) => `lesson-${i + 1}`),
    last_accessed_at: '2024-01-15T00:00:00Z',
    enrolled_at: '2023-12-01T00:00:00Z',
    completed_at: '2024-01-15T00:00:00Z',
    certificate_id: 'cert-1',
  },
  {
    id: 'enrollment-5',
    student_id: 'student-2',
    course_id: 'course-4',
    student: students[1],
    course: courses[3],
    status: 'active',
    progress_percentage: 78,
    completed_lessons: Array.from({ length: 66 }, (_, i) => `lesson-${i + 1}`),
    last_accessed_at: new Date(Date.now() - 1000 * 60 * 60 * 5).toISOString(),
    enrolled_at: '2024-01-02T00:00:00Z',
  },
  {
    id: 'enrollment-6',
    student_id: 'student-3',
    course_id: 'course-2',
    student: students[2],
    course: courses[1],
    status: 'active',
    progress_percentage: 34,
    completed_lessons: Array.from({ length: 19 }, (_, i) => `lesson-${i + 1}`),
    last_accessed_at: new Date(Date.now() - 1000 * 60 * 60 * 72).toISOString(),
    enrolled_at: '2024-01-12T00:00:00Z',
  },
  {
    id: 'enrollment-7',
    student_id: 'student-4',
    course_id: 'course-5',
    student: students[3],
    course: courses[4],
    status: 'completed',
    progress_percentage: 100,
    completed_lessons: Array.from({ length: 52 }, (_, i) => `lesson-${i + 1}`),
    last_accessed_at: '2024-01-10T00:00:00Z',
    enrolled_at: '2023-11-15T00:00:00Z',
    completed_at: '2024-01-10T00:00:00Z',
    certificate_id: 'cert-2',
  },
]

// Mock Live Training Sessions
export const liveTrainings: LiveTraining[] = [
  {
    id: 'live-1',
    course_id: 'course-1',
    course: courses[0],
    title: 'Live Q&A Session: Advanced React Patterns',
    description: 'Ask your questions about React patterns, hooks, and best practices.',
    instructor_id: 'instructor-1',
    instructor: instructors[0],
    platform: 'zoom',
    meeting_url: 'https://zoom.us/j/123456789',
    meeting_id: '123 456 789',
    meeting_password: 'react2024',
    scheduled_start: new Date(Date.now() + 2 * 24 * 60 * 60 * 1000).toISOString(),
    scheduled_end: new Date(Date.now() + 2 * 24 * 60 * 60 * 1000 + 60 * 60 * 1000).toISOString(),
    status: 'scheduled',
    max_participants: 100,
    registered_participants: ['student-1', 'student-2'],
    attended_participants: [],
    is_recurring: false,
    created_at: '2024-01-15T00:00:00Z',
    updated_at: '2024-01-15T00:00:00Z',
  },
  {
    id: 'live-2',
    course_id: 'course-4',
    course: courses[3],
    title: 'Workshop: Building Neural Networks from Scratch',
    description: 'Hands-on workshop to build a neural network using only NumPy.',
    instructor_id: 'instructor-4',
    instructor: instructors[3],
    platform: 'google_meet',
    meeting_url: 'https://meet.google.com/abc-defg-hij',
    scheduled_start: new Date(Date.now() + 5 * 24 * 60 * 60 * 1000).toISOString(),
    scheduled_end: new Date(Date.now() + 5 * 24 * 60 * 60 * 1000 + 2 * 60 * 60 * 1000).toISOString(),
    status: 'scheduled',
    max_participants: 50,
    registered_participants: ['student-2', 'student-4'],
    attended_participants: [],
    is_recurring: false,
    created_at: '2024-01-16T00:00:00Z',
    updated_at: '2024-01-16T00:00:00Z',
  },
  {
    id: 'live-3',
    title: 'Weekly Office Hours',
    description: 'Open Q&A session for all enrolled students.',
    instructor_id: 'instructor-1',
    instructor: instructors[0],
    platform: 'zoom',
    meeting_url: 'https://zoom.us/j/987654321',
    meeting_id: '987 654 321',
    scheduled_start: new Date(Date.now() + 7 * 24 * 60 * 60 * 1000).toISOString(),
    scheduled_end: new Date(Date.now() + 7 * 24 * 60 * 60 * 1000 + 60 * 60 * 1000).toISOString(),
    status: 'scheduled',
    max_participants: 200,
    registered_participants: [],
    attended_participants: [],
    is_recurring: true,
    recurrence_rule: 'FREQ=WEEKLY;BYDAY=FR',
    created_at: '2024-01-10T00:00:00Z',
    updated_at: '2024-01-10T00:00:00Z',
  },
]

// Mock Certificates
export const certificates: Certificate[] = [
  {
    id: 'cert-1',
    student_id: 'student-2',
    course_id: 'course-1',
    course_title: 'Advanced React Patterns & Best Practices',
    student_name: 'Sarah Smith',
    issue_date: '2024-01-15T00:00:00Z',
    certificate_number: 'PLA-2024-001234',
    verification_url: 'https://phazurlabs.com/verify/PLA-2024-001234',
    pdf_url: '/certificates/PLA-2024-001234.pdf',
  },
  {
    id: 'cert-2',
    student_id: 'student-4',
    course_id: 'course-5',
    course_title: 'UI/UX Design Masterclass',
    student_name: 'Emily Wilson',
    issue_date: '2024-01-10T00:00:00Z',
    certificate_number: 'PLA-2024-001089',
    verification_url: 'https://phazurlabs.com/verify/PLA-2024-001089',
    pdf_url: '/certificates/PLA-2024-001089.pdf',
  },
]

// Mock Activities
export const activities: Activity[] = [
  {
    id: 'activity-1',
    type: 'enrollment',
    message: 'New enrollment in "Advanced React Patterns"',
    user_id: 'student-1',
    course_id: 'course-1',
    created_at: new Date(Date.now() - 2 * 60 * 1000).toISOString(),
  },
  {
    id: 'activity-2',
    type: 'completion',
    message: 'Sarah Smith completed "Advanced React Patterns"',
    user_id: 'student-2',
    course_id: 'course-1',
    created_at: new Date(Date.now() - 15 * 60 * 1000).toISOString(),
  },
  {
    id: 'activity-3',
    type: 'video_upload',
    message: 'New video uploaded to "AI Fundamentals"',
    course_id: 'course-4',
    created_at: new Date(Date.now() - 60 * 60 * 1000).toISOString(),
  },
  {
    id: 'activity-4',
    type: 'certificate',
    message: 'Certificate issued to Emily Wilson',
    user_id: 'student-4',
    course_id: 'course-5',
    related_id: 'cert-2',
    created_at: new Date(Date.now() - 2 * 60 * 60 * 1000).toISOString(),
  },
  {
    id: 'activity-5',
    type: 'quiz',
    message: '23 students completed "Python Basics" quiz',
    course_id: 'course-8',
    created_at: new Date(Date.now() - 3 * 60 * 60 * 1000).toISOString(),
  },
  {
    id: 'activity-6',
    type: 'live_training',
    message: 'Live Q&A session scheduled for "React Patterns"',
    course_id: 'course-1',
    related_id: 'live-1',
    created_at: new Date(Date.now() - 24 * 60 * 60 * 1000).toISOString(),
  },
]

// Helper functions to get data
export function getCourseById(id: string): Course | undefined {
  return courses.find(c => c.id === id)
}

export function getStudentById(id: string): Student | undefined {
  return students.find(s => s.id === id)
}

export function getInstructorById(id: string): Instructor | undefined {
  return instructors.find(i => i.id === id)
}

export function getEnrollmentsByStudentId(studentId: string): Enrollment[] {
  return enrollments.filter(e => e.student_id === studentId)
}

export function getEnrollmentsByCourseId(courseId: string): Enrollment[] {
  return enrollments.filter(e => e.course_id === courseId)
}

export function getLiveTrainingsByCourseId(courseId: string): LiveTraining[] {
  return liveTrainings.filter(lt => lt.course_id === courseId)
}

export function getUpcomingLiveTrainings(): LiveTraining[] {
  const now = new Date().toISOString()
  return liveTrainings
    .filter(lt => lt.scheduled_start > now && lt.status === 'scheduled')
    .sort((a, b) => a.scheduled_start.localeCompare(b.scheduled_start))
}

export function getCertificatesByStudentId(studentId: string): Certificate[] {
  return certificates.filter(c => c.student_id === studentId)
}

// Calculate admin dashboard stats
export function getAdminDashboardStats(): AdminDashboardStats {
  const publishedCourses = courses.filter(c => c.status === 'published')
  const totalRevenue = publishedCourses.reduce((sum, c) => sum + c.revenue, 0)
  const totalEnrollments = publishedCourses.reduce((sum, c) => sum + c.enrolled_students, 0)
  const avgCompletionRate = publishedCourses.reduce((sum, c) => sum + c.completion_rate, 0) / publishedCourses.length
  const avgRating = publishedCourses.reduce((sum, c) => sum + c.rating, 0) / publishedCourses.length

  return {
    total_students: students.length * 2567, // Mock multiplier
    active_students: Math.floor(students.length * 2567 * 0.72),
    total_courses: courses.length,
    published_courses: publishedCourses.length,
    total_enrollments: totalEnrollments,
    total_completions: Math.floor(totalEnrollments * 0.35),
    total_revenue: totalRevenue,
    monthly_revenue: Math.floor(totalRevenue * 0.15),
    average_completion_rate: Math.round(avgCompletionRate),
    average_rating: Math.round(avgRating * 10) / 10,
  }
}

// Calculate student analytics
export function getStudentAnalytics(studentId: string): StudentAnalytics {
  const studentEnrollments = getEnrollmentsByStudentId(studentId)
  const student = getStudentById(studentId)
  const completedCourses = studentEnrollments.filter(e => e.status === 'completed')
  const certs = getCertificatesByStudentId(studentId)

  return {
    student_id: studentId,
    total_courses_enrolled: studentEnrollments.length,
    courses_completed: completedCourses.length,
    certificates_earned: certs.length,
    total_hours_learned: student?.total_hours_learned || 0,
    current_streak: student?.streak_days || 0,
    longest_streak: 21,
    average_quiz_score: 85,
    learning_by_day: [
      { day: 'Mon', hours: 2.5 },
      { day: 'Tue', hours: 1.8 },
      { day: 'Wed', hours: 3.2 },
      { day: 'Thu', hours: 2.1 },
      { day: 'Fri', hours: 1.5 },
      { day: 'Sat', hours: 4.0 },
      { day: 'Sun', hours: 2.8 },
    ],
    category_distribution: [
      { category: 'Web Development', hours: 45 },
      { category: 'Programming Languages', hours: 38 },
      { category: 'Backend Development', hours: 25 },
      { category: 'AI & Machine Learning', hours: 30 },
      { category: 'Design', hours: 18 },
    ],
  }
}
